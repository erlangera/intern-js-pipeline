(self.webpackChunkdocusaurus_dashboard=self.webpackChunkdocusaurus_dashboard||[]).push([[195],{1410:(e,t,a)=>{const r=a(7694),o=a(3618),s={title:"Nightly Integration Tests Dashboard",url:"https://erlangera.github.io",baseUrl:"/test-report-dashboard/",onBrokenLinks:"throw",onBrokenMarkdownLinks:"warn",favicon:"img/favicon.ico",organizationName:"erlangera",projectName:"docusaurus",deploymentBranch:"gh-pages",i18n:{defaultLocale:"en",locales:["en"]},presets:[["classic",{docs:{sidebarPath:6679},blog:{showReadingTime:!0,blogSidebarCount:"ALL",blogSidebarTitle:"Articles",postsPerPage:1},theme:{customCss:2295}}]],themeConfig:{tableOfContents:{minHeadingLevel:2,maxHeadingLevel:3},navbar:{title:"Dashboard",logo:{alt:"Dashboard Logo",src:"img/logo.svg"},items:[{type:"doc",docId:"intro",position:"left",label:"Documentation"},{label:"Sign in",href:"https://github.com/login/oauth/authorize?client_id=af5779b1f85c21ef8665&state=123",position:"right",target:"_self","aria-label":"GitHub repository"},{href:"https://github.com/erlangera/test-report-dashboard",position:"right",className:"header-github-link","aria-label":"GitHub repository"}]},footer:{style:"dark",links:[],copyright:"Copyright \xa9 "+(new Date).getFullYear()+" Microsoft. Built with Docusaurus."},prism:{theme:r,darkTheme:o}}};e.exports=s},6679:e=>{e.exports={tutorialSidebar:[{type:"autogenerated",dirName:"."}]}},5631:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>B});var r=a(2164),o=a(7294);const s="Pane_iFq7";var n=a(1410),l=a.n(n);const c=e=>{const t="https://github.com/"+e.orgName+"/"+e.repoName+"/actions/workflows/playwright-onDemand.yml/badge.svg",a="https://github.com/"+e.orgName+"/"+e.repoName+"/actions/workflows/playwright-onDemand.yml",r=l().url+l().baseUrl+"test-reports/"+e.orgName+"/"+e.repoName+"/onDemand";return o.createElement("div",{className:s},o.createElement("a",{href:a},o.createElement("h4",null,"Latest Run")),o.createElement("a",{href:r},o.createElement("img",{src:t})))},i="Pane_FOkR",m="RedBox_D9Td",u="GreenBox_ZvGz",h="GreyBox_HevE",g=e=>{const t=l().url+l().baseUrl+"test-reports/"+e.orgName+"/"+e.repoName+"/"+e.date;return"success"==e.pass?o.createElement("a",{className:u,href:t}):"failed"==e.pass?o.createElement("a",{className:m,href:t}):o.createElement("a",{className:h})};var d=a(9669),p=a.n(d);let f="";const N=e=>{f=e},b=async(e,t)=>{const a="https://api.github.com/repos/"+e+"/"+t.name+"/actions/workflows";return(await p().get(a,{headers:{Authorization:f?"token "+f:""}})).data.workflows},w=e=>{const[t,a]=(0,o.useState)([]),[r,s]=(0,o.useState)([]),n=(e.orgName,e.repoName,"https://github.com/"+e.orgName+"/"+e.repoName+"/actions/workflows/playwright-scheduled.yml");async function l(){try{const r=await(async(e,t)=>{const a="https://api.github.com/repos/"+e+"/"+t+"/actions/workflows/playwright-scheduled.yml/runs",r=await p().get(a,{headers:{Authorization:f?"token "+f:""}});if(404==r.status)return["null","null","null","null","null","null","null"];let o=[];for(let s=0;s<7;s++)o=r.data.total_count>6-s?[...o,r.data.workflow_runs[6-s].conclusion]:[...o,"null"];return o})(e.orgName,e.repoName);[...r]!=[...t]&&a(r)}catch(r){console.error(r)}}return(0,o.useEffect)((()=>{let e=new Date,t=[];for(let r=0;r<7;r++){let r=(a=e.getFullYear(),o=e.getMonth()+1,n=e.getDate(),a+"-"+(o<10?"0":"")+o+"-"+(n<10?"0":"")+n);t=[...t,r],e.setDate(e.getDate()-1)}var a,o,n;[...t]!=[...r]&&s(t),l()}),[]),o.createElement("div",{className:i},o.createElement("h4",null,o.createElement("a",{href:n},"Nightly Tests")),o.createElement("span",null,t.map(((t,a)=>o.createElement(g,{key:a,date:r[6-a],pass:t,orgName:e.orgName,repoName:e.repoName})))))},y="Card_O3LJ",E="Title_a4s6",k="Panes_fOsJ",v=e=>{const t="https://github.com/"+e.orgName+"/"+e.repoName;return o.createElement("div",{className:y},o.createElement("a",{href:t},o.createElement("h3",{className:E},e.repoName)),o.createElement("div",{className:k},o.createElement(c,{orgName:e.orgName,repoName:e.repoName}),o.createElement(w,{orgName:e.orgName,repoName:e.repoName})))},_="Title_ceoZ",D="Intro_c1ql",L=()=>o.createElement("div",null,o.createElement("h1",{className:_},"Nightly Integration Tests Dashboard"),o.createElement("p",{className:D},o.createElement("b",null,"For each repo card:"),"The left side (",o.createElement("i",null,"Latest Run"),") displays the test status for the most recent run (caused by commits, pull requests or manual dispatch). The right side (",o.createElement("i",null,"Nightly Tests"),") displays status of nightly integration tests for the past week (7 day history).")),T="erlangera";const P=function(){const[e,t]=(0,o.useState)([]);async function a(){console.log("fetch repos");try{const a=await(async e=>{const t="https://api.github.com/users/"+e+"/repos",a=await p().get(t,{headers:{Authorization:f?"token "+f:""}}),r=await a.data.filter((async e=>await Promise.resolve(!1))),o=await Promise.all(r.map((t=>b(e,t)))),s=r.filter(((e,t)=>o[t].find((e=>"Scheduled Playwright tests"===e.name)))).map((e=>e.name));return s.sort(),s})(T);[...a]!=[...e]&&t(a)}catch(a){console.error(a)}}async function r(e){try{const{token:t}=await async function(e){const t="https://erlangera.azurewebsites.net/api/oauth?code="+e;return(await p().get(t,{headers:{}})).data}(e);localStorage.setItem("access_token",t),N(t)}catch(t){console.error(t)}}return(0,o.useEffect)((async()=>{const e=localStorage.getItem("access_token"),t=new URL(location.href).searchParams.get("code");console.log("check",e,t),e&&N(e),!e&&t&&(console.log("fetch token"),await r(t)),a()}),[]),o.createElement("div",null,o.createElement(L,null),e.map((e=>o.createElement(v,{key:e,repoName:e,orgName:T}))))},S="Background_WWgh";var C=a(2263);const B=()=>{const{siteConfig:e}=(0,C.Z)();return o.createElement(r.Z,{title:""+e.title,description:"Description will go into a meta tag in <head />"},o.createElement("main",null,o.createElement("div",{className:S},o.createElement(P,null))))}}}]);